apiVersion: v1
kind: Secret
metadata:
  name: mysql-secrets
  namespace: default
type: Opaque
data:
  mysql_conn_str: cm9vdDpwYXNzd29yZEB0Y3AoMTAuMTUyLjE4My43MDozMzA2KS9rZWRh # base64 encoded value of mysql connectionString of format user:password@tcp(serviceip:3306)/stats_db
---
apiVersion: keda.sh/v1alpha1
kind: TriggerAuthentication
metadata:
  name: keda-trigger-auth-mysql-secret
  namespace: default
spec:
  secretTargetRef:
  - parameter: connectionString
    name: mysql-secrets
    key: mysql_conn_str
---
apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: mysql-scaledobject
  namespace: default
spec:
  maxReplicaCount: 4
  pollingInterval: 3  # Optional. Default: 30 seconds
  cooldownPeriod:  5 # Optional. Default: 300 seconds
  scaleTargetRef:
    name: mysql-deployment
  triggers:
  - type: mysql
    metadata:
      queryValue: "5"
      query: "SELECT trigger_uno FROM keda WHERE trigger_uno = '5'"
    authenticationRef:
      name: keda-trigger-auth-mysql-secret
